import React, { <% if (forward) { %>forwardRef<% } %> } from 'react';

<% if (asChild) { %>
import { Slot } from '@radix-ui/react-slot';
<% } %>

<% if (variants) { %>
import { cn, cvm, InferVariantPropsWithClass } from '@ssword/utils-dom';
<% } %>

// component configuration

// component inheritance base
const base = 'div';

<% if (variants) { %>
// component variant manager
const <%= componentName %>VM = cvm('', {
  variants: {},
  defaultVariants: {},
  compoundVariants: []
});
<% } %>

// type alias for typeof base
type BaseComponent = typeof base;

interface <%= componentExportName %>Props
  extends React.ComponentProps<BaseComponent>
  <% if (variants) { %>, InferVariantPropsWithClass<typeof <%= componentName %>VM><% } %> {
  /* props here */
  <% if (asChild) { %>asChild?: boolean;<% } %>
}

const <%= componentExportName %> =
  <% if (forward) { %>forwardRef(<% } %>((
    {
      <% if (asChild) { %>asChild = false,<% } %>
      className,
      ...props
    }: <%= componentExportName %>Props,
    <% if (forward) { %>forwardedRef<% } %>
  ) => {
    <% if (asChild) { %>
    // decide which element to render
    const Comp = asChild ? Slot : base;
    <% } else { %>
    const Comp = base;
    <% } %>

    <% if (variants) { %>
    // split out children
    const { children, ...restProps } = props;

    // compute variant classes
    const classes = <%= componentName %>VM(restProps);
    <% } %>

    return (
      <Comp
        <% if (variants) { %>
        {...restProps}
        <% } else { %>
        {...props}
        <% } %>
        <% if (forward) { %>ref={forwardedRef}<% } %>
        className={
          <% if (variants) { %>
          cn(classes, className)
          <% } else { %>
          className
          <% } %>
        }
      >
        {props.children}
      </Comp>
    );
  })<% if (forward) { %>)<% } %>;

export default <%= componentExportName %>;
